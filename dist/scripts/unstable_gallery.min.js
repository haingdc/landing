import e from"../scripts/getColor.min.js";var t=!1;function a(){t||(t=!0,requestAnimationFrame(function(o){if(t=!1,0===data.length)return void a();(function(t){var a=null==y.keydown?null:y.keydown.code,o=null;null!=y.click&&(o=y.click.target,v.x=y.click.clientX,v.y=y.click.clientY),null!=y.mousemove&&(v.x=y.mousemove.clientX,v.y=y.mousemove.clientY);for(var x=document.documentElement.clientWidth,b=document.documentElement.clientHeight,z=c.matches,M=d?document.body.scrollTop:window.scrollY,k=d?document.body.scrollLeft:window.scrollX,X=window.location.hash.slice(1),E=null,Y=0;Y<data.length;Y++)data[Y].id===X&&(E=Y);var L=v.x+k,S=v.y+M,A="Escape"===a?null:("ArrowLeft"===a||"ArrowRight"===a)&&null==E?0:"ArrowLeft"===a?Math.max(0,E-1):"ArrowRight"===a?Math.min(data.length-1,E+1):E;if(null!=o)if("FIGCAPTION"===o.tagName){var C,F=window.getSelection(),N=document.createRange();N.selectNodeContents(o),F.removeAllRanges(),F.addRange(N)}else null==E?console.log("newFocused",A=null!=(C=g(data,L,S))?C:A):A=w(data,E,x,L);for(var T=s(x),R=T.cols,D=T.boxMaxSizeX,I=[],H=[],W=[40],_=0,j=0;j<data.length;j++){var q=data[j],G=1===q.ar?.85*D:q.ar<1?1.05*D:D,O=Math.min(q.naturalSizeX,D,G*q.ar),P=O/q.ar+l;I.push(O),H.push(P),_=Math.max(_,P),(j%R==R-1||j===data.length-1)&&(W.push(W.at(-1)+_+24),_=0)}var B=u,J=M;if(null==A){if(null!=E){var K=W[Math.floor(E/R)];(K<=M||K+H[E]>=M+b)&&(J=K-24-40)}for(var Q=0;Q<data.length;Q++){var U=data[Q],V=I[Q],Z=H[Q],$=Math.floor(Q/R),ee=W[$+1]-24-W[$];U.sizeX.dest=V,U.sizeY.dest=Z,U.x.dest=24+Q%R*(D+24)+(D-V)/2,U.y.dest=W[$]+(ee-Z)/2,U.scale.dest=1,U.fxFactor.dest=1}var et=g(data,L,S);if(null==et)eC="auto";else{eC="zoom-in";var ea=data[et],eo=ea.x,en=ea.y,el=ea.sizeX,er=ea.sizeY,es=ea.scale;eo.dest+=(L-(eo.dest+el.dest/2))/40,en.dest+=(S-(en.dest+er.dest/2))/40,es.dest=1.02}var ed=data[u].y.dest-40;if(x!==h&&(J=Math.max(0,ed)),J!==m&&Math.abs(ed-J)>b/10)for(B=0;B<data.length;B+=R){var ei=data[B];if(ei.y.dest+ei.sizeY.dest-J>b/5)break}}else{for(var ec=b-40-r-28,eu=x-104-200,eh=152,em=A-1;em>=0;em--){var ev=data[em];eh-=.7*Math.min(ev.naturalSizeX,eu,ec*ev.ar)+52}for(var ey="ArrowLeft"===a&&0===E?2e3:"ArrowRight"===a&&E===data.length-1?-2e3:0,ep=0;ep<data.length;ep++){var ef=data[ep],eg=Math.min(ef.naturalSizeX,eu,ec*ef.ar)*(ep===A?1:.7),ew=eg/ef.ar+r;ef.sizeX.dest=eg,ef.sizeY.dest=ew,ef.y.dest=Math.max(40,(b-ew)/2)+J,ef.x.dest=ep===A?(x-eg)/2:eh,ef.x.v+=ey/(ep===A?1:4),ef.scale.dest=1,ef.fxFactor.dest=ep===A?1:.2,eh=ep===A?x-100:eh+eg+52}var ex=w(data,A,x,L);if(null==ex)eC="zoom-out";else{eC="zoom-in";var eb=data[ex],ez=eb.x,eM=eb.y,ek=eb.sizeX,eX=eb.sizeY,eE=eb.scale,eY=eb.fxFactor;ez.dest+=(L-(ez.dest+ek.dest/2))/40,eM.dest+=(S-(eM.dest+eX.dest/2))/40,eE.dest=1.02,eY.dest=.5}}var eL=!0,eS=!1,eA=void 0;try{for(var eC,eF,eN=data[Symbol.iterator]();!(eL=(eF=eN.next()).done);eL=!0){var eT=eF.value.y;eT.pos+=J-M}}catch(e){eS=!0,eA=e}finally{try{eL||null==eN.return||eN.return()}finally{if(eS)throw eA}}var eR=null!=i?i:t,eD=Math.floor((t-eR)/4);eR+=4*eD;var eI=!1;z?p(n):p(function(e){for(var t=0;t<eD;t++)!function(e){var t=e.pos,a=e.dest,o=e.v,n=o+(-e.k*(t-a)+-e.b*o)*.004;e.pos=t+.004*n,e.v=n}(e);.01>Math.abs(e.v)&&.01>Math.abs(e.dest-e.pos)?n(e):eI=!0});for(var eH=0;eH<data.length;eH++){var eW=data[eH],e_=eW.node,ej=e_.children[0],eq=e_.children[1],eG=e_.children[2];if(eW.y.pos-J<=b+150&&eW.y.pos+eW.sizeY.pos-J>=-100&&eW.x.pos<=x&&eW.x.pos+eW.sizeX.pos>=0){if(e_.style.width="".concat(eW.sizeX.pos,"px"),e_.style.height="".concat(eW.sizeY.pos,"px"),e_.style.transform="translate3d(".concat(eW.x.pos,"px,").concat(eW.y.pos,"px,0) scale(").concat(eW.scale.pos,")"),e_.style.filter=null!=A&&eH===A-1||eH===A||eH===A+1?"brightness(".concat(100*eW.fxFactor.pos,"%) blur(").concat(Math.max(0,6-6*eW.fxFactor.pos),"px)"):"brightness(".concat(100*eW.fxFactor.pos,"%)"),eq.style.top="".concat(eW.sizeX.pos/eW.ar,"px"),eH===A){e_.style.zIndex=data.length+999,eq.style.overflowY="auto",eq.style.height="".concat(r-8,"px"),eq.style.lineClamp=eq.style.webkitLineClamp=999,ej.style.display="block",eW.id,eG.style.width=eG.style.height="".concat(100,"px"),eG.style.left="".concat((eW.sizeX.pos-100)/2,"px");var eO=e(eW.ratioDailyTarget),eP=eO.light,eB=eO.saturation,eJ=eO.hue;eG.style.background="hsl(".concat(eJ,"deg ").concat(eB,"% ").concat(eP,"%)")}else{e_.style.zIndex=eH+1,eq.style.overflowY="hidden",eq.style.height="".concat(l-8,"px"),eq.style.lineClamp=eq.style.webkitLineClamp=2,ej.style.display="none",eG.style.width=eG.style.height="".concat(100,"px"),eG.style.left="".concat((eW.sizeX.pos-100)/2,"px"),eG.style.top="".concat((eW.sizeY.pos-100)/2,"px");var eK=e(eW.ratioDailyTarget),eQ=eK.light,eU=eK.saturation,eV=eK.hue;eG.style.background="hsl(".concat(eV,"deg ").concat(eU,"% ").concat(eQ,"%)")}null==e_.parentNode&&document.body.appendChild(e_)}else null!=e_.parentNode&&document.body.removeChild(e_)}return document.body.style.cursor=eC,document.body.style.overflowY=null==A?"auto":"hidden",f.style.height="".concat(W.at(-1),"px"),J!==M&&(d?document.body:window).scrollTo({top:J}),A!==E&&window.history.pushState(null,"","".concat(window.location.pathname).concat(window.location.search).concat(null==A?"":"#"+data[A].id)),y.keydown=y.click=y.mousemove=null,i=eI?eR:null,u=B,h=x,m=J,eI})(o)&&a()}))}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:290,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;return{pos:e,dest:e,v:t,k:a,b:o}}function n(e){e.pos=e.dest,e.v=0}var l=52,r=72;function s(e){var t,a=(t=Math.floor((e-24)/244))>7?7:t<1?1:t;return{cols:a,boxMaxSizeX:(e-24-24*a)/a}}var d=navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome");d&&(document.body.style.contain="layout",document.body.style.width="100vw",document.body.style.height="100vh");var i=null,c=window.matchMedia("(prefers-reduced-motion: reduce)"),u=0,h=document.documentElement.clientWidth,m=d?document.body.scrollTop:window.scrollY,v={x:-1/0,y:-1/0},y={keydown:null,click:null,mousemove:null};function p(e){var t=!0,a=!1,o=void 0;try{for(var n,l=data[Symbol.iterator]();!(t=(n=l.next()).done);t=!0){var r=n.value;e(r.sizeX),e(r.sizeY),e(r.x),e(r.y),e(r.scale),e(r.fxFactor)}}catch(e){a=!0,o=e}finally{try{t||null==l.return||l.return()}finally{if(a)throw o}}}var f=document.createElement("div");function g(e,t,a){for(var o=0;o<e.length;o++){var n=e[o],l=n.x,r=n.y,s=n.sizeX,d=n.sizeY;if(l.dest<=t&&t<l.dest+s.dest&&r.dest<=a&&a<r.dest+d.dest)return o}return null}function w(e,t,a,o){return t>0&&0<=o&&o<=100?Math.max(0,t-1):t<e.length-1&&o>=a-100?Math.min(e.length-1,t+1):null}f.style.position="absolute",f.style.width="1px",document.body.append(f);export default{scheduleRender:a,addEventListeners:function(){window.addEventListener("resize",function(){return a()}),window.addEventListener("scroll",function(){return a()},!0),window.addEventListener("popstate",function(){return a()}),window.addEventListener("keydown",function(e){y.keydown=e,a()}),window.addEventListener("click",function(e){y.click=e,a()}),window.addEventListener("mousemove",function(e){y.mousemove=e,a()})},prepareData:function(){var e=document.documentElement.clientHeight,t=s(h),a=t.cols,n=t.boxMaxSizeX,r=n+100;data=data.map(function(t,s){var d=t.w/t.h,i=Math.min(t.w,n,r*d),c=document.createElement("div");c.className="box",c.setAttribute("onclick","void(0)"),c.style.backgroundImage="url(https://cdn.ngayhe.com/".concat(t.id,"_384_N.webp)");var u=document.createElement("img"),m=document.createElement("figcaption");m.className="prompt",m.textContent=t.prompt;var v=document.createElement("div");v.className="chỉ-thị-m\xe0u";var y=document.createElement("div");if(y.className="header",y.textContent=t.header,void 0===t.ratioDailyTarget){var p=document.createElement("img");p.src="/img/Snoopy-doghouse-1.png",v.append(p)}return c.append(u,m,v,y),{id:t.id,naturalSizeX:t.w,ar:d,sizeX:o(i),sizeY:o(i/d+l),x:o(-(Math.floor(s/a)*h)-h),y:o(e+Math.floor(s/a)*r),scale:o(1),fxFactor:o(20),node:c,ratioDailyTarget:t.ratioDailyTarget}})}};
//# sourceMappingURL=unstable_gallery.min.js.map